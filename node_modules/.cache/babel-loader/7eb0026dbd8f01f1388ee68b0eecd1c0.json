{"remainingRequest":"E:\\demo\\pikaz-excel-js\\node_modules\\babel-loader\\lib\\index.js!E:\\demo\\pikaz-excel-js\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\demo\\pikaz-excel-js\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\demo\\pikaz-excel-js\\src\\plugin\\excelImport\\excelImport.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\demo\\pikaz-excel-js\\src\\plugin\\excelImport\\excelImport.vue","mtime":1610165480628},{"path":"E:\\demo\\pikaz-excel-js\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\demo\\pikaz-excel-js\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\demo\\pikaz-excel-js\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\demo\\pikaz-excel-js\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS51aW50OC1hcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmNvcHktd2l0aGluIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZXZlcnkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWxsIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQtaW5kZXgiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5sYXN0LWluZGV4LW9mIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLXJpZ2h0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmV2ZXJzZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNldCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNsaWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29tZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNvcnQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zdWJhcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLWxvY2FsZS1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0IF9yZWFkT25seUVycm9yIGZyb20gIkU6L2RlbW8vcGlrYXotZXhjZWwtanMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3JlYWRPbmx5RXJyb3IiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJFOi9kZW1vL3Bpa2F6LWV4Y2VsLWpzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFhMU1ggZnJvbSAieGxzeCI7CmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgLy8g6KGo5ZCNCiAgICBzaGVldE5hbWVzOiBBcnJheSwKICAgIC8vIOaYr+WQpuenu+mZpOepuuagvAogICAgcmVtb3ZlQmxhbmtzcGFjZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIC8vIOaYr+WQpuenu+WHuueJueauiuWtl+espgogICAgcmVtb3ZlU3BlY2lhbGNoYXI6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKICAgIC8vICDlr7zlhaXliY0KICAgIGJlZm9yZUltcG9ydDogewogICAgICB0eXBlOiBGdW5jdGlvbiwKICAgICAgLy8gZmlsZeS4uuWvvOWFpeaWh+S7tgogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdChmaWxlKSB7fQogICAgfSwKICAgIC8vIOWvvOWFpeaXtgogICAgb25Qcm9ncmVzczogewogICAgICB0eXBlOiBGdW5jdGlvbiwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoZXZlbnQsIGZpbGUpIHt9CiAgICB9LAogICAgLy8g54q25oCB5pS55Y+YCiAgICBvbkNoYW5nZTogewogICAgICB0eXBlOiBGdW5jdGlvbiwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoZmlsZSkge30KICAgIH0sCiAgICBvblN1Y2Nlc3M6IHsKICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgIC8vIHJlc3BvbnNl5Li655Sf5oiQ55qEanNvbuaVsOaNrgogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdChyZXNwb25zZSwgZmlsZSkge30KICAgIH0sCiAgICBvbkVycm9yOiB7CiAgICAgIHR5cGU6IEZ1bmN0aW9uLAogICAgICAvLyBlcnLkuLrplJnor6/kv6Hmga8KICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoZXJyLCBmaWxlKSB7fQogICAgfQogIH0sCiAgY29tcG9uZW50czoge30sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGltRmlsZTogIiIsCiAgICAgIC8vIOaemuS4vuexuwogICAgICBlbnVtOiB7CiAgICAgICAgLy8g5paH5Lu257G75Z6LCiAgICAgICAgYm9va1R5cGU6IFsieGxzeCIsICJ4bHMiXQogICAgICB9LAogICAgICBpZDogIiIKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5pZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB0aGlzLmltRmlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuaWQpOwogIH0sCiAgbWV0aG9kczogewogICAgLyoqDQogICAgICogQG5hbWU6IOeCueWHu+WvvOWFpeaMiemSrg0KICAgICAqIEBwYXJhbSB7dHlwZX0NCiAgICAgKiBAcmV0dXJuOg0KICAgICAqLwogICAgaW1wb3J0RmlsZUNsaWNrOiBmdW5jdGlvbiBpbXBvcnRGaWxlQ2xpY2soKSB7CiAgICAgIHRoaXMuaW1GaWxlLmNsaWNrKCk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEBuYW1lOiDlr7zlhaXmlofku7YNCiAgICAgKiBAcGFyYW0ge3R5cGV9DQogICAgICogQHJldHVybjoNCiAgICAgKi8KICAgIGltcG9ydEZpbGU6IGZ1bmN0aW9uIGltcG9ydEZpbGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvLyDlr7zlhaVleGNlbAogICAgICB2YXIgb2JqID0gdGhpcy5pbUZpbGU7IC8vIOaXoOWvvOWFpeaWh+S7tgoKICAgICAgaWYgKCFvYmouZmlsZXMpIHsKICAgICAgICB0aGlzLm9uRXJyb3IoIk5vIGltcG9ydGVkIGZpbGUiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBmaWxlID0gb2JqLmZpbGVzWzBdOyAvLyDlr7zlhaXliY0KCiAgICAgIHZhciBiZWZvcmVJbXBvcnQgPSB0aGlzLmJlZm9yZUltcG9ydChmaWxlKTsKICAgICAgdGhpcy5vbkNoYW5nZShmaWxlKTsKCiAgICAgIGlmIChiZWZvcmVJbXBvcnQgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOaWh+S7tuexu+Wei+W/hemhu+S4unhsc3jmiJbogIV4bHMKCgogICAgICB2YXIgYm9va1R5cGUgPSBmaWxlLm5hbWUuc3Vic3RyKGZpbGUubmFtZS5sZW5ndGggLSA0LCBmaWxlLm5hbWUubGVuZ3RoIC0gMSk7CiAgICAgIHZhciB0eXBlID0gdGhpcy5lbnVtLmJvb2tUeXBlLnNvbWUoZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoYm9va1R5cGUuaW5kZXhPZihlKSAhPT0gLTEpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9KTsKCiAgICAgIGlmICghdHlwZSkgewogICAgICAgIHRoaXMub25FcnJvcignVGhlIGZpbGUgdHlwZSBtdXN0IGJlICJ4bHN4IiBvciAieGxzIicsIGZpbGUpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgIHZhciB0aGF0ID0gdGhpczsgLy8g5a+85YWl5pe2CgogICAgICByZWFkZXIub25wcm9ncmVzcyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXMub25Qcm9ncmVzcyhlLCBmaWxlKTsKICAgICAgfTsgLy8g5a+85YWl5a6M5oiQCgoKICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIGRhdGEgPSBlLnRhcmdldC5yZXN1bHQ7CgogICAgICAgIGlmICh0aGF0LnJBQlMpIHsKICAgICAgICAgIHRoYXQud2IgPSBYTFNYLnJlYWQoYnRvYShfdGhpcy5maXhkYXRhKGRhdGEpKSwgewogICAgICAgICAgICAvLyDmiYvliqjovazljJYKICAgICAgICAgICAgdHlwZTogImJhc2U2NCIKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGF0LndiID0gWExTWC5yZWFkKGRhdGEsIHsKICAgICAgICAgICAgdHlwZTogImJpbmFyeSIKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgdmFyIGpzb24gPSBbXTsgLy8g5p+l6K+i5a+55bqU6KGo5ZCN5pWw5o2uCgogICAgICAgIGlmICh0aGF0LnNoZWV0TmFtZXMpIHsKICAgICAgICAgIHRoYXQuc2hlZXROYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgICAgIHZhciBzaGVldEluZGV4ID0gdGhhdC53Yi5TaGVldE5hbWVzLmZpbmRJbmRleChmdW5jdGlvbiAocykgewogICAgICAgICAgICAgIHJldHVybiBzID09PSBuYW1lOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChzaGVldEluZGV4ICE9PSAtMSkgewogICAgICAgICAgICAgIHZhciBfZGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih0aGF0LndiLlNoZWV0c1t0aGF0LndiLlNoZWV0TmFtZXNbc2hlZXRJbmRleF1dKTsKCiAgICAgICAgICAgICAganNvbi5wdXNoKHsKICAgICAgICAgICAgICAgIHNoZWV0TmFtZTogbmFtZSwKICAgICAgICAgICAgICAgIGRhdGE6IF9kYXRhCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDmn6Xor6Llhajpg6jmlbDmja4KICAgICAgICAgIHRoYXQud2IuU2hlZXROYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHZhciBkYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKHRoYXQud2IuU2hlZXRzW2l0ZW1dKTsKICAgICAgICAgICAganNvbi5wdXNoKHsKICAgICAgICAgICAgICBzaGVldE5hbWU6IGl0ZW0sCiAgICAgICAgICAgICAgZGF0YTogZGF0YQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAganNvbiA9IF90aGlzLmRlYWxEYXRhKGpzb24pOwogICAgICAgIHRoYXQuaW1wb3J0RGF0YShqc29uLCBmaWxlKTsKICAgICAgfTsKCiAgICAgIGlmICh0aGlzLnJBQlMpIHsKICAgICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVhZGVyLnJlYWRBc0JpbmFyeVN0cmluZyhmaWxlKTsKICAgICAgfQogICAgfSwKCiAgICAvKioNCiAgICAgKiBAbmFtZTog5aSE55CG5a+85YWl5pWw5o2uDQogICAgICogQHBhcmFtIHt0eXBlfQ0KICAgICAqIEByZXR1cm46DQogICAgICovCiAgICBkZWFsRGF0YTogZnVuY3Rpb24gZGVhbERhdGEoZGF0YSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmICh0aGlzLnJlbW92ZUJsYW5rc3BhY2UgfHwgdGhpcy5yZW1vdmVTcGVjaWFsY2hhcikgewogICAgICAgIHZhciBqc29uID0gZGF0YS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHZhciBpdGVtRGF0YSA9IGl0ZW0uZGF0YS5tYXAoZnVuY3Rpb24gKGkpIHsKICAgICAgICAgICAgT2JqZWN0LmtleXMoaSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICAgICAgaWYgKF90aGlzMi5yZW1vdmVCbGFua3NwYWNlICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpW2tleV0pID09PSAiW29iamVjdCBTdHJpbmddIikgewogICAgICAgICAgICAgICAgLy8g5a2X56ym5Liy5Y676Zmk56m65qC8CiAgICAgICAgICAgICAgICBpW2tleV0gPSBpW2tleV0ucmVwbGFjZSgvXHMqL2csICIiKTsKICAgICAgICAgICAgICB9IC8vIOWOu+mZpOeJueauiuWtl+espgoKCiAgICAgICAgICAgICAgaWYgKF90aGlzMi5yZW1vdmVTcGVjaWFsY2hhciAmJiBpW2tleV0gJiYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGlba2V5XSkgIT09ICJbb2JqZWN0IEJvb2xlYW5dIikgewogICAgICAgICAgICAgICAgaVtrZXldID0gaVtrZXldLnRvU3RyaW5nKCkucmVwbGFjZSgvW1x1MjAwYi1cdTIwMGZcdUZFRkZcdTIwMmEtXHUyMDJlXS9nLCAiIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGl0ZW0pLCB7fSwgewogICAgICAgICAgICBkYXRhOiBpdGVtRGF0YQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGpzb247CiAgICAgIH0KCiAgICAgIHJldHVybiBkYXRhOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBAbmFtZTog5a+85YWl5pWw5o2uDQogICAgICogQHBhcmFtIHt0eXBlfQ0KICAgICAqIEByZXR1cm46DQogICAgICovCiAgICBpbXBvcnREYXRhOiBmdW5jdGlvbiBpbXBvcnREYXRhKGRhdGEsIGZpbGUpIHsKICAgICAgdGhpcy5pbUZpbGUudmFsdWUgPSAiIjsKCiAgICAgIGlmIChkYXRhLmxlbmd0aCA8PSAwKSB7CiAgICAgICAgLy8g5a+85YWl5aSx6LSlCiAgICAgICAgdGhpcy5vbkNoYW5nZShmaWxlKTsKICAgICAgICB0aGlzLm9uRXJyb3IoIlRoZSBpbXBvcnQgZmFpbGVkIiwgZmlsZSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIC8v5a+85YWl5oiQ5YqfCiAgICAgICAgdGhpcy5vbkNoYW5nZShmaWxlKTsKICAgICAgICB0aGlzLm9uU3VjY2VzcyhkYXRhLCBmaWxlKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0sCgogICAgLyoqDQogICAgICogQG5hbWU6IOaWh+S7tua1gei9rEJpbmFyeVN0cmluZw0KICAgICAqIEBwYXJhbSB7dHlwZX0NCiAgICAgKiBAcmV0dXJuOg0KICAgICAqLwogICAgZml4ZGF0YTogZnVuY3Rpb24gZml4ZGF0YShkYXRhKSB7CiAgICAgIHZhciBvID0gIiI7CiAgICAgIHZhciBsID0gMDsKICAgICAgdmFyIHcgPSAxMDI0MDsKCiAgICAgIGZvciAoOyBsIDwgZGF0YS5ieXRlTGVuZ3RoIC8gdzsgX3JlYWRPbmx5RXJyb3IoImwiKSwgKytsKSB7CiAgICAgICAgbyArPSAoX3JlYWRPbmx5RXJyb3IoIm8iKSwgU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBuZXcgVWludDhBcnJheShkYXRhLnNsaWNlKGwgKiB3LCBsICogdyArIHcpKSkpOwogICAgICB9CgogICAgICBvICs9IChfcmVhZE9ubHlFcnJvcigibyIpLCBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIG5ldyBVaW50OEFycmF5KGRhdGEuc2xpY2UobCAqIHcpKSkpOwogICAgICByZXR1cm4gbzsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7fSwKICB3YXRjaDoge30KfTs="},{"version":3,"sources":["excelImport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,OAAA,IAAA,MAAA,MAAA;AACA,eAAA;AACA,EAAA,KAAA,EAAA;AACA;AACA,IAAA,UAAA,EAAA,KAFA;AAGA;AACA,IAAA,gBAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,MAAA,OAAA,EAAA;AAFA,KAJA;AAQA;AACA,IAAA,iBAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,MAAA,OAAA,EAAA;AAFA,KATA;AAaA;AACA,IAAA,YAAA,EAAA;AACA,MAAA,IAAA,EAAA,QADA;AAEA;AACA,MAAA,OAAA,EAAA,kBAAA,IAAA,EAAA,CAAA;AAHA,KAdA;AAmBA;AACA,IAAA,UAAA,EAAA;AACA,MAAA,IAAA,EAAA,QADA;AAEA,MAAA,OAAA,EAAA,kBAAA,KAAA,EAAA,IAAA,EAAA,CAAA;AAFA,KApBA;AAwBA;AACA,IAAA,QAAA,EAAA;AACA,MAAA,IAAA,EAAA,QADA;AAEA,MAAA,OAAA,EAAA,kBAAA,IAAA,EAAA,CAAA;AAFA,KAzBA;AA6BA,IAAA,SAAA,EAAA;AACA,MAAA,IAAA,EAAA,QADA;AAEA;AACA,MAAA,OAAA,EAAA,kBAAA,QAAA,EAAA,IAAA,EAAA,CAAA;AAHA,KA7BA;AAkCA,IAAA,OAAA,EAAA;AACA,MAAA,IAAA,EAAA,QADA;AAEA;AACA,MAAA,OAAA,EAAA,kBAAA,GAAA,EAAA,IAAA,EAAA,CAAA;AAHA;AAlCA,GADA;AAyCA,EAAA,UAAA,EAAA,EAzCA;AA0CA,EAAA,IA1CA,kBA0CA;AACA,WAAA;AACA,MAAA,MAAA,EAAA,EADA;AAEA;AACA,MAAA,IAAA,EAAA;AACA;AACA,QAAA,QAAA,EAAA,CAAA,MAAA,EAAA,KAAA;AAFA,OAHA;AAOA,MAAA,EAAA,EAAA;AAPA,KAAA;AASA,GApDA;AAqDA,EAAA,OArDA,qBAqDA;AACA,SAAA,EAAA,GAAA,IAAA,CAAA,MAAA,GAAA,QAAA,EAAA;AACA,GAvDA;AAwDA,EAAA,OAxDA,qBAwDA;AACA,SAAA,MAAA,GAAA,QAAA,CAAA,cAAA,CAAA,KAAA,EAAA,CAAA;AACA,GA1DA;AA2DA,EAAA,OAAA,EAAA;AACA;;;;;AAKA,IAAA,eANA,6BAMA;AACA,WAAA,MAAA,CAAA,KAAA;AACA,KARA;;AASA;;;;;AAKA,IAAA,UAdA,wBAcA;AAAA;;AACA;AACA,UAAA,GAAA,GAAA,KAAA,MAAA,CAFA,CAGA;;AACA,UAAA,CAAA,GAAA,CAAA,KAAA,EAAA;AACA,aAAA,OAAA,CAAA,kBAAA;AACA;AACA;;AACA,UAAA,IAAA,GAAA,GAAA,CAAA,KAAA,CAAA,CAAA,CAAA,CARA,CASA;;AACA,UAAA,YAAA,GAAA,KAAA,YAAA,CAAA,IAAA,CAAA;AACA,WAAA,QAAA,CAAA,IAAA;;AACA,UAAA,YAAA,KAAA,KAAA,EAAA;AACA;AACA,OAdA,CAeA;;;AACA,UAAA,QAAA,GAAA,IAAA,CAAA,IAAA,CAAA,MAAA,CACA,IAAA,CAAA,IAAA,CAAA,MAAA,GAAA,CADA,EAEA,IAAA,CAAA,IAAA,CAAA,MAAA,GAAA,CAFA,CAAA;AAIA,UAAA,IAAA,GAAA,KAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,UAAA,CAAA,EAAA;AACA,YAAA,QAAA,CAAA,OAAA,CAAA,CAAA,MAAA,CAAA,CAAA,EAAA;AACA,iBAAA,IAAA;AACA;;AACA,eAAA,KAAA;AACA,OALA,CAAA;;AAMA,UAAA,CAAA,IAAA,EAAA;AACA,aAAA,OAAA,CAAA,uCAAA,EAAA,IAAA;AACA;AACA;;AACA,UAAA,MAAA,GAAA,IAAA,UAAA,EAAA;AACA,UAAA,IAAA,GAAA,IAAA,CA/BA,CAgCA;;AACA,MAAA,MAAA,CAAA,UAAA,GAAA,UAAA,CAAA,EAAA;AACA,QAAA,KAAA,CAAA,UAAA,CAAA,CAAA,EAAA,IAAA;AACA,OAFA,CAjCA,CAoCA;;;AACA,MAAA,MAAA,CAAA,MAAA,GAAA,UAAA,CAAA,EAAA;AACA,YAAA,IAAA,GAAA,CAAA,CAAA,MAAA,CAAA,MAAA;;AACA,YAAA,IAAA,CAAA,IAAA,EAAA;AACA,UAAA,IAAA,CAAA,EAAA,GAAA,IAAA,CAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,OAAA,CAAA,IAAA,CAAA,CAAA,EAAA;AACA;AACA,YAAA,IAAA,EAAA;AAFA,WAAA,CAAA;AAIA,SALA,MAKA;AACA,UAAA,IAAA,CAAA,EAAA,GAAA,IAAA,CAAA,IAAA,CAAA,IAAA,EAAA;AACA,YAAA,IAAA,EAAA;AADA,WAAA,CAAA;AAGA;;AACA,YAAA,IAAA,GAAA,EAAA,CAZA,CAaA;;AACA,YAAA,IAAA,CAAA,UAAA,EAAA;AACA,UAAA,IAAA,CAAA,UAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,gBAAA,UAAA,GAAA,IAAA,CAAA,EAAA,CAAA,UAAA,CAAA,SAAA,CACA,UAAA,CAAA;AAAA,qBAAA,CAAA,KAAA,IAAA;AAAA,aADA,CAAA;;AAGA,gBAAA,UAAA,KAAA,CAAA,CAAA,EAAA;AACA,kBAAA,KAAA,GAAA,IAAA,CAAA,KAAA,CAAA,aAAA,CACA,IAAA,CAAA,EAAA,CAAA,MAAA,CAAA,IAAA,CAAA,EAAA,CAAA,UAAA,CAAA,UAAA,CAAA,CADA,CAAA;;AAGA,cAAA,IAAA,CAAA,IAAA,CAAA;AAAA,gBAAA,SAAA,EAAA,IAAA;AAAA,gBAAA,IAAA,EAAA;AAAA,eAAA;AACA;AACA,WAVA;AAWA,SAZA,MAYA;AACA;AACA,UAAA,IAAA,CAAA,EAAA,CAAA,UAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,gBAAA,IAAA,GAAA,IAAA,CAAA,KAAA,CAAA,aAAA,CACA,IAAA,CAAA,EAAA,CAAA,MAAA,CAAA,IAAA,CADA,CAAA;AAGA,YAAA,IAAA,CAAA,IAAA,CAAA;AAAA,cAAA,SAAA,EAAA,IAAA;AAAA,cAAA,IAAA,EAAA;AAAA,aAAA;AACA,WALA;AAMA;;AACA,QAAA,IAAA,GAAA,KAAA,CAAA,QAAA,CAAA,IAAA,CAAA;AACA,QAAA,IAAA,CAAA,UAAA,CAAA,IAAA,EAAA,IAAA;AACA,OArCA;;AAsCA,UAAA,KAAA,IAAA,EAAA;AACA,QAAA,MAAA,CAAA,iBAAA,CAAA,IAAA;AACA,OAFA,MAEA;AACA,QAAA,MAAA,CAAA,kBAAA,CAAA,IAAA;AACA;AACA,KA9FA;;AA+FA;;;;;AAKA,IAAA,QApGA,oBAoGA,IApGA,EAoGA;AAAA;;AACA,UAAA,KAAA,gBAAA,IAAA,KAAA,iBAAA,EAAA;AACA,YAAA,IAAA,GAAA,IAAA,CAAA,GAAA,CAAA,UAAA,IAAA,EAAA;AACA,cAAA,QAAA,GAAA,IAAA,CAAA,IAAA,CAAA,GAAA,CAAA,UAAA,CAAA,EAAA;AACA,YAAA,MAAA,CAAA,IAAA,CAAA,CAAA,EAAA,OAAA,CAAA,UAAA,GAAA,EAAA;AACA,kBACA,MAAA,CAAA,gBAAA,IACA,MAAA,CAAA,SAAA,CAAA,QAAA,CAAA,IAAA,CAAA,CAAA,CAAA,GAAA,CAAA,MACA,iBAHA,EAIA;AACA;AACA,gBAAA,CAAA,CAAA,GAAA,CAAA,GAAA,CAAA,CAAA,GAAA,CAAA,CAAA,OAAA,CAAA,MAAA,EAAA,EAAA,CAAA;AACA,eARA,CASA;;;AACA,kBACA,MAAA,CAAA,iBAAA,IACA,CAAA,CAAA,GAAA,CADA,IAEA,MAAA,CAAA,SAAA,CAAA,QAAA,CAAA,IAAA,CAAA,CAAA,CAAA,GAAA,CAAA,MACA,kBAJA,EAKA;AACA,gBAAA,CAAA,CAAA,GAAA,CAAA,GAAA,CAAA,CAAA,GAAA,CAAA,CACA,QADA,GAEA,OAFA,CAGA,qCAHA,EAIA,EAJA,CAAA;AAMA;AACA,aAvBA;AAwBA,mBAAA,CAAA;AACA,WA1BA,CAAA;AA2BA,iDAAA,IAAA;AAAA,YAAA,IAAA,EAAA;AAAA;AACA,SA7BA,CAAA;AA8BA,eAAA,IAAA;AACA;;AACA,aAAA,IAAA;AACA,KAvIA;;AAwIA;;;;;AAKA,IAAA,UA7IA,sBA6IA,IA7IA,EA6IA,IA7IA,EA6IA;AACA,WAAA,MAAA,CAAA,KAAA,GAAA,EAAA;;AACA,UAAA,IAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA;AACA,aAAA,QAAA,CAAA,IAAA;AACA,aAAA,OAAA,CAAA,mBAAA,EAAA,IAAA;AACA;AACA,OALA,MAKA;AACA;AACA,aAAA,QAAA,CAAA,IAAA;AACA,aAAA,SAAA,CAAA,IAAA,EAAA,IAAA;AACA;AACA;AACA,KA1JA;;AA2JA;;;;;AAKA,IAAA,OAhKA,mBAgKA,IAhKA,EAgKA;AACA,UAAA,CAAA,GAAA,EAAA;AACA,UAAA,CAAA,GAAA,CAAA;AACA,UAAA,CAAA,GAAA,KAAA;;AACA,aAAA,CAAA,GAAA,IAAA,CAAA,UAAA,GAAA,CAAA,uBAAA,EAAA,CAAA,EAAA;AACA,QAAA,CAAA,0BAAA,MAAA,CAAA,YAAA,CAAA,KAAA,CACA,IADA,EAEA,IAAA,UAAA,CAAA,IAAA,CAAA,KAAA,CAAA,CAAA,GAAA,CAAA,EAAA,CAAA,GAAA,CAAA,GAAA,CAAA,CAAA,CAFA,CAAA,CAAA;AAIA;;AACA,MAAA,CAAA,0BAAA,MAAA,CAAA,YAAA,CAAA,KAAA,CACA,IADA,EAEA,IAAA,UAAA,CAAA,IAAA,CAAA,KAAA,CAAA,CAAA,GAAA,CAAA,CAAA,CAFA,CAAA,CAAA;AAIA,aAAA,CAAA;AACA;AA/KA,GA3DA;AA4OA,EAAA,QAAA,EAAA,EA5OA;AA6OA,EAAA,KAAA,EAAA;AA7OA,CAAA","sourcesContent":["<!--\r\n * @Author: zouzheng\r\n * @Date: 2020-04-30 15:05:31\r\n * @LastEditors: zouzheng\r\n * @LastEditTime: 2020-10-28 00:47:07\r\n * @Description: 这是excel导入组件（页面）\r\n -->\r\n<template>\r\n    <div\r\n        class=\"excel-import\"\r\n        @click=\"importFileClick\"\r\n    >\r\n        <input\r\n            type=\"file\"\r\n            @change=\"importFile(this)\"\r\n            :id=\"id\"\r\n            style=\"display: none\"\r\n            accept=\".xls,.xlsx\"\r\n        />\r\n        <slot></slot>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport XLSX from \"xlsx\";\r\nexport default {\r\n    props: {\r\n        // 表名\r\n        sheetNames: Array,\r\n        // 是否移除空格\r\n        removeBlankspace: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        // 是否移出特殊字符\r\n        removeSpecialchar: {\r\n            type: Boolean,\r\n            default: true\r\n        },\r\n        //  导入前\r\n        beforeImport: {\r\n            type: Function,\r\n            // file为导入文件\r\n            default: file => {}\r\n        },\r\n        // 导入时\r\n        onProgress: {\r\n            type: Function,\r\n            default: (event, file) => {}\r\n        },\r\n        // 状态改变\r\n        onChange: {\r\n            type: Function,\r\n            default: file => {}\r\n        },\r\n        onSuccess: {\r\n            type: Function,\r\n            // response为生成的json数据\r\n            default: (response, file) => {}\r\n        },\r\n        onError: {\r\n            type: Function,\r\n            // err为错误信息\r\n            default: (err, file) => {}\r\n        }\r\n    },\r\n    components: {},\r\n    data() {\r\n        return {\r\n            imFile: \"\",\r\n            // 枚举类\r\n            enum: {\r\n                // 文件类型\r\n                bookType: [\"xlsx\", \"xls\"]\r\n            },\r\n            id: \"\"\r\n        };\r\n    },\r\n    created() {\r\n        this.id = Math.random().toString();\r\n    },\r\n    mounted() {\r\n        this.imFile = document.getElementById(this.id);\r\n    },\r\n    methods: {\r\n        /**\r\n         * @name: 点击导入按钮\r\n         * @param {type}\r\n         * @return:\r\n         */\r\n        importFileClick() {\r\n            this.imFile.click();\r\n        },\r\n        /**\r\n         * @name: 导入文件\r\n         * @param {type}\r\n         * @return:\r\n         */\r\n        importFile() {\r\n            // 导入excel\r\n            const obj = this.imFile;\r\n            // 无导入文件\r\n            if (!obj.files) {\r\n                this.onError(\"No imported file\");\r\n                return;\r\n            }\r\n            const file = obj.files[0];\r\n            // 导入前\r\n            const beforeImport = this.beforeImport(file);\r\n            this.onChange(file);\r\n            if (beforeImport === false) {\r\n                return;\r\n            }\r\n            // 文件类型必须为xlsx或者xls\r\n            const bookType = file.name.substr(\r\n                file.name.length - 4,\r\n                file.name.length - 1\r\n            );\r\n            const type = this.enum.bookType.some(e => {\r\n                if (bookType.indexOf(e) !== -1) {\r\n                    return true;\r\n                }\r\n                return false;\r\n            });\r\n            if (!type) {\r\n                this.onError('The file type must be \"xlsx\" or \"xls\"', file);\r\n                return;\r\n            }\r\n            const reader = new FileReader();\r\n            const that = this;\r\n            // 导入时\r\n            reader.onprogress = e => {\r\n                this.onProgress(e, file);\r\n            };\r\n            // 导入完成\r\n            reader.onload = e => {\r\n                const data = e.target.result;\r\n                if (that.rABS) {\r\n                    that.wb = XLSX.read(btoa(this.fixdata(data)), {\r\n                        // 手动转化\r\n                        type: \"base64\"\r\n                    });\r\n                } else {\r\n                    that.wb = XLSX.read(data, {\r\n                        type: \"binary\"\r\n                    });\r\n                }\r\n                let json = [];\r\n                // 查询对应表名数据\r\n                if (that.sheetNames) {\r\n                    that.sheetNames.forEach(name => {\r\n                        const sheetIndex = that.wb.SheetNames.findIndex(\r\n                            s => s === name\r\n                        );\r\n                        if (sheetIndex !== -1) {\r\n                            const data = XLSX.utils.sheet_to_json(\r\n                                that.wb.Sheets[that.wb.SheetNames[sheetIndex]]\r\n                            );\r\n                            json.push({ sheetName: name, data });\r\n                        }\r\n                    });\r\n                } else {\r\n                    // 查询全部数据\r\n                    that.wb.SheetNames.forEach(item => {\r\n                        const data = XLSX.utils.sheet_to_json(\r\n                            that.wb.Sheets[item]\r\n                        );\r\n                        json.push({ sheetName: item, data });\r\n                    });\r\n                }\r\n                json = this.dealData(json);\r\n                that.importData(json, file);\r\n            };\r\n            if (this.rABS) {\r\n                reader.readAsArrayBuffer(file);\r\n            } else {\r\n                reader.readAsBinaryString(file);\r\n            }\r\n        },\r\n        /**\r\n         * @name: 处理导入数据\r\n         * @param {type}\r\n         * @return:\r\n         */\r\n        dealData(data) {\r\n            if (this.removeBlankspace || this.removeSpecialchar) {\r\n                const json = data.map(item => {\r\n                    const itemData = item.data.map(i => {\r\n                        Object.keys(i).forEach(key => {\r\n                            if (\r\n                                this.removeBlankspace &&\r\n                                Object.prototype.toString.call(i[key]) ===\r\n                                    \"[object String]\"\r\n                            ) {\r\n                                // 字符串去除空格\r\n                                i[key] = i[key].replace(/\\s*/g, \"\");\r\n                            }\r\n                            // 去除特殊字符\r\n                            if (\r\n                                this.removeSpecialchar &&\r\n                                i[key] &&\r\n                                Object.prototype.toString.call(i[key]) !==\r\n                                    \"[object Boolean]\"\r\n                            ) {\r\n                                i[key] = i[key]\r\n                                    .toString()\r\n                                    .replace(\r\n                                        /[\\u200b-\\u200f\\uFEFF\\u202a-\\u202e]/g,\r\n                                        \"\"\r\n                                    );\r\n                            }\r\n                        });\r\n                        return i;\r\n                    });\r\n                    return { ...item, data: itemData };\r\n                });\r\n                return json;\r\n            }\r\n            return data;\r\n        },\r\n        /**\r\n         * @name: 导入数据\r\n         * @param {type}\r\n         * @return:\r\n         */\r\n        importData(data, file) {\r\n            this.imFile.value = \"\";\r\n            if (data.length <= 0) {\r\n                // 导入失败\r\n                this.onChange(file);\r\n                this.onError(\"The import failed\", file);\r\n                return;\r\n            } else {\r\n                //导入成功\r\n                this.onChange(file);\r\n                this.onSuccess(data, file);\r\n                return;\r\n            }\r\n        },\r\n        /**\r\n         * @name: 文件流转BinaryString\r\n         * @param {type}\r\n         * @return:\r\n         */\r\n        fixdata(data) {\r\n            const o = \"\";\r\n            const l = 0;\r\n            const w = 10240;\r\n            for (; l < data.byteLength / w; ++l) {\r\n                o += String.fromCharCode.apply(\r\n                    null,\r\n                    new Uint8Array(data.slice(l * w, l * w + w))\r\n                );\r\n            }\r\n            o += String.fromCharCode.apply(\r\n                null,\r\n                new Uint8Array(data.slice(l * w))\r\n            );\r\n            return o;\r\n        }\r\n    },\r\n    computed: {},\r\n    watch: {}\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n</style>"],"sourceRoot":"src/plugin/excelImport"}]}