{"remainingRequest":"E:\\demo\\pikaz-excel-js\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\demo\\pikaz-excel-js\\src\\plugin\\excelImport\\excelImport.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\demo\\pikaz-excel-js\\src\\plugin\\excelImport\\excelImport.vue","mtime":1610165480628},{"path":"E:\\demo\\pikaz-excel-js\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\demo\\pikaz-excel-js\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\demo\\pikaz-excel-js\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\demo\\pikaz-excel-js\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgWExTWCBmcm9tICJ4bHN4IjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgICBwcm9wczogew0KICAgICAgICAvLyDooajlkI0NCiAgICAgICAgc2hlZXROYW1lczogQXJyYXksDQogICAgICAgIC8vIOaYr+WQpuenu+mZpOepuuagvA0KICAgICAgICByZW1vdmVCbGFua3NwYWNlOiB7DQogICAgICAgICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UNCiAgICAgICAgfSwNCiAgICAgICAgLy8g5piv5ZCm56e75Ye654m55q6K5a2X56ymDQogICAgICAgIHJlbW92ZVNwZWNpYWxjaGFyOiB7DQogICAgICAgICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgICAgICAgZGVmYXVsdDogdHJ1ZQ0KICAgICAgICB9LA0KICAgICAgICAvLyAg5a+85YWl5YmNDQogICAgICAgIGJlZm9yZUltcG9ydDogew0KICAgICAgICAgICAgdHlwZTogRnVuY3Rpb24sDQogICAgICAgICAgICAvLyBmaWxl5Li65a+85YWl5paH5Lu2DQogICAgICAgICAgICBkZWZhdWx0OiBmaWxlID0+IHt9DQogICAgICAgIH0sDQogICAgICAgIC8vIOWvvOWFpeaXtg0KICAgICAgICBvblByb2dyZXNzOiB7DQogICAgICAgICAgICB0eXBlOiBGdW5jdGlvbiwNCiAgICAgICAgICAgIGRlZmF1bHQ6IChldmVudCwgZmlsZSkgPT4ge30NCiAgICAgICAgfSwNCiAgICAgICAgLy8g54q25oCB5pS55Y+YDQogICAgICAgIG9uQ2hhbmdlOiB7DQogICAgICAgICAgICB0eXBlOiBGdW5jdGlvbiwNCiAgICAgICAgICAgIGRlZmF1bHQ6IGZpbGUgPT4ge30NCiAgICAgICAgfSwNCiAgICAgICAgb25TdWNjZXNzOiB7DQogICAgICAgICAgICB0eXBlOiBGdW5jdGlvbiwNCiAgICAgICAgICAgIC8vIHJlc3BvbnNl5Li655Sf5oiQ55qEanNvbuaVsOaNrg0KICAgICAgICAgICAgZGVmYXVsdDogKHJlc3BvbnNlLCBmaWxlKSA9PiB7fQ0KICAgICAgICB9LA0KICAgICAgICBvbkVycm9yOiB7DQogICAgICAgICAgICB0eXBlOiBGdW5jdGlvbiwNCiAgICAgICAgICAgIC8vIGVycuS4uumUmeivr+S/oeaBrw0KICAgICAgICAgICAgZGVmYXVsdDogKGVyciwgZmlsZSkgPT4ge30NCiAgICAgICAgfQ0KICAgIH0sDQogICAgY29tcG9uZW50czoge30sDQogICAgZGF0YSgpIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGltRmlsZTogIiIsDQogICAgICAgICAgICAvLyDmnprkuL7nsbsNCiAgICAgICAgICAgIGVudW06IHsNCiAgICAgICAgICAgICAgICAvLyDmlofku7bnsbvlnosNCiAgICAgICAgICAgICAgICBib29rVHlwZTogWyJ4bHN4IiwgInhscyJdDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgaWQ6ICIiDQogICAgICAgIH07DQogICAgfSwNCiAgICBjcmVhdGVkKCkgew0KICAgICAgICB0aGlzLmlkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygpOw0KICAgIH0sDQogICAgbW91bnRlZCgpIHsNCiAgICAgICAgdGhpcy5pbUZpbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmlkKTsNCiAgICB9LA0KICAgIG1ldGhvZHM6IHsNCiAgICAgICAgLyoqDQogICAgICAgICAqIEBuYW1lOiDngrnlh7vlr7zlhaXmjInpkq4NCiAgICAgICAgICogQHBhcmFtIHt0eXBlfQ0KICAgICAgICAgKiBAcmV0dXJuOg0KICAgICAgICAgKi8NCiAgICAgICAgaW1wb3J0RmlsZUNsaWNrKCkgew0KICAgICAgICAgICAgdGhpcy5pbUZpbGUuY2xpY2soKTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIEBuYW1lOiDlr7zlhaXmlofku7YNCiAgICAgICAgICogQHBhcmFtIHt0eXBlfQ0KICAgICAgICAgKiBAcmV0dXJuOg0KICAgICAgICAgKi8NCiAgICAgICAgaW1wb3J0RmlsZSgpIHsNCiAgICAgICAgICAgIC8vIOWvvOWFpWV4Y2VsDQogICAgICAgICAgICBjb25zdCBvYmogPSB0aGlzLmltRmlsZTsNCiAgICAgICAgICAgIC8vIOaXoOWvvOWFpeaWh+S7tg0KICAgICAgICAgICAgaWYgKCFvYmouZmlsZXMpIHsNCiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoIk5vIGltcG9ydGVkIGZpbGUiKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjb25zdCBmaWxlID0gb2JqLmZpbGVzWzBdOw0KICAgICAgICAgICAgLy8g5a+85YWl5YmNDQogICAgICAgICAgICBjb25zdCBiZWZvcmVJbXBvcnQgPSB0aGlzLmJlZm9yZUltcG9ydChmaWxlKTsNCiAgICAgICAgICAgIHRoaXMub25DaGFuZ2UoZmlsZSk7DQogICAgICAgICAgICBpZiAoYmVmb3JlSW1wb3J0ID09PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8vIOaWh+S7tuexu+Wei+W/hemhu+S4unhsc3jmiJbogIV4bHMNCiAgICAgICAgICAgIGNvbnN0IGJvb2tUeXBlID0gZmlsZS5uYW1lLnN1YnN0cigNCiAgICAgICAgICAgICAgICBmaWxlLm5hbWUubGVuZ3RoIC0gNCwNCiAgICAgICAgICAgICAgICBmaWxlLm5hbWUubGVuZ3RoIC0gMQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSB0aGlzLmVudW0uYm9va1R5cGUuc29tZShlID0+IHsNCiAgICAgICAgICAgICAgICBpZiAoYm9va1R5cGUuaW5kZXhPZihlKSAhPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgaWYgKCF0eXBlKSB7DQogICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdUaGUgZmlsZSB0eXBlIG11c3QgYmUgInhsc3giIG9yICJ4bHMiJywgZmlsZSk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzOw0KICAgICAgICAgICAgLy8g5a+85YWl5pe2DQogICAgICAgICAgICByZWFkZXIub25wcm9ncmVzcyA9IGUgPT4gew0KICAgICAgICAgICAgICAgIHRoaXMub25Qcm9ncmVzcyhlLCBmaWxlKTsNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICAvLyDlr7zlhaXlrozmiJANCiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBlID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gZS50YXJnZXQucmVzdWx0Ow0KICAgICAgICAgICAgICAgIGlmICh0aGF0LnJBQlMpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC53YiA9IFhMU1gucmVhZChidG9hKHRoaXMuZml4ZGF0YShkYXRhKSksIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaJi+WKqOi9rOWMlg0KICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImJhc2U2NCINCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC53YiA9IFhMU1gucmVhZChkYXRhLCB7DQogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiYmluYXJ5Ig0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbGV0IGpzb24gPSBbXTsNCiAgICAgICAgICAgICAgICAvLyDmn6Xor6Llr7nlupTooajlkI3mlbDmja4NCiAgICAgICAgICAgICAgICBpZiAodGhhdC5zaGVldE5hbWVzKSB7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuc2hlZXROYW1lcy5mb3JFYWNoKG5hbWUgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2hlZXRJbmRleCA9IHRoYXQud2IuU2hlZXROYW1lcy5maW5kSW5kZXgoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcyA9PiBzID09PSBuYW1lDQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoZWV0SW5kZXggIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbigNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC53Yi5TaGVldHNbdGhhdC53Yi5TaGVldE5hbWVzW3NoZWV0SW5kZXhdXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbi5wdXNoKHsgc2hlZXROYW1lOiBuYW1lLCBkYXRhIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAvLyDmn6Xor6Llhajpg6jmlbDmja4NCiAgICAgICAgICAgICAgICAgICAgdGhhdC53Yi5TaGVldE5hbWVzLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQud2IuU2hlZXRzW2l0ZW1dDQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICAgICAganNvbi5wdXNoKHsgc2hlZXROYW1lOiBpdGVtLCBkYXRhIH0pOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAganNvbiA9IHRoaXMuZGVhbERhdGEoanNvbik7DQogICAgICAgICAgICAgICAgdGhhdC5pbXBvcnREYXRhKGpzb24sIGZpbGUpOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIGlmICh0aGlzLnJBQlMpIHsNCiAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNCaW5hcnlTdHJpbmcoZmlsZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiBAbmFtZTog5aSE55CG5a+85YWl5pWw5o2uDQogICAgICAgICAqIEBwYXJhbSB7dHlwZX0NCiAgICAgICAgICogQHJldHVybjoNCiAgICAgICAgICovDQogICAgICAgIGRlYWxEYXRhKGRhdGEpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLnJlbW92ZUJsYW5rc3BhY2UgfHwgdGhpcy5yZW1vdmVTcGVjaWFsY2hhcikgew0KICAgICAgICAgICAgICAgIGNvbnN0IGpzb24gPSBkYXRhLm1hcChpdGVtID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbURhdGEgPSBpdGVtLmRhdGEubWFwKGkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoaSkuZm9yRWFjaChrZXkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVCbGFua3NwYWNlICYmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpW2tleV0pID09PQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIltvYmplY3QgU3RyaW5nXSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5a2X56ym5Liy5Y676Zmk56m65qC8DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlba2V5XSA9IGlba2V5XS5yZXBsYWNlKC9ccyovZywgIiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDljrvpmaTnibnmrorlrZfnrKYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU3BlY2lhbGNoYXIgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaVtrZXldICYmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpW2tleV0pICE9PQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIltvYmplY3QgQm9vbGVhbl0iDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlba2V5XSA9IGlba2V5XQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvU3RyaW5nKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9bXHUyMDBiLVx1MjAwZlx1RkVGRlx1MjAyYS1cdTIwMmVdL2csDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB7IC4uLml0ZW0sIGRhdGE6IGl0ZW1EYXRhIH07DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGpzb247DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZGF0YTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIEBuYW1lOiDlr7zlhaXmlbDmja4NCiAgICAgICAgICogQHBhcmFtIHt0eXBlfQ0KICAgICAgICAgKiBAcmV0dXJuOg0KICAgICAgICAgKi8NCiAgICAgICAgaW1wb3J0RGF0YShkYXRhLCBmaWxlKSB7DQogICAgICAgICAgICB0aGlzLmltRmlsZS52YWx1ZSA9ICIiOw0KICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoIDw9IDApIHsNCiAgICAgICAgICAgICAgICAvLyDlr7zlhaXlpLHotKUNCiAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKGZpbGUpOw0KICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcigiVGhlIGltcG9ydCBmYWlsZWQiLCBmaWxlKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8v5a+85YWl5oiQ5YqfDQogICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZShmaWxlKTsNCiAgICAgICAgICAgICAgICB0aGlzLm9uU3VjY2VzcyhkYXRhLCBmaWxlKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiBAbmFtZTog5paH5Lu25rWB6L2sQmluYXJ5U3RyaW5nDQogICAgICAgICAqIEBwYXJhbSB7dHlwZX0NCiAgICAgICAgICogQHJldHVybjoNCiAgICAgICAgICovDQogICAgICAgIGZpeGRhdGEoZGF0YSkgew0KICAgICAgICAgICAgY29uc3QgbyA9ICIiOw0KICAgICAgICAgICAgY29uc3QgbCA9IDA7DQogICAgICAgICAgICBjb25zdCB3ID0gMTAyNDA7DQogICAgICAgICAgICBmb3IgKDsgbCA8IGRhdGEuYnl0ZUxlbmd0aCAvIHc7ICsrbCkgew0KICAgICAgICAgICAgICAgIG8gKz0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseSgNCiAgICAgICAgICAgICAgICAgICAgbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgbmV3IFVpbnQ4QXJyYXkoZGF0YS5zbGljZShsICogdywgbCAqIHcgKyB3KSkNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgbyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KA0KICAgICAgICAgICAgICAgIG51bGwsDQogICAgICAgICAgICAgICAgbmV3IFVpbnQ4QXJyYXkoZGF0YS5zbGljZShsICogdykpDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgcmV0dXJuIG87DQogICAgICAgIH0NCiAgICB9LA0KICAgIGNvbXB1dGVkOiB7fSwNCiAgICB3YXRjaDoge30NCn07DQo="},{"version":3,"sources":["excelImport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"excelImport.vue","sourceRoot":"src/plugin/excelImport","sourcesContent":["<!--\r\n * @Author: zouzheng\r\n * @Date: 2020-04-30 15:05:31\r\n * @LastEditors: zouzheng\r\n * @LastEditTime: 2020-10-28 00:47:07\r\n * @Description: 这是excel导入组件（页面）\r\n -->\r\n<template>\r\n    <div\r\n        class=\"excel-import\"\r\n        @click=\"importFileClick\"\r\n    >\r\n        <input\r\n            type=\"file\"\r\n            @change=\"importFile(this)\"\r\n            :id=\"id\"\r\n            style=\"display: none\"\r\n            accept=\".xls,.xlsx\"\r\n        />\r\n        <slot></slot>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport XLSX from \"xlsx\";\r\nexport default {\r\n    props: {\r\n        // 表名\r\n        sheetNames: Array,\r\n        // 是否移除空格\r\n        removeBlankspace: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        // 是否移出特殊字符\r\n        removeSpecialchar: {\r\n            type: Boolean,\r\n            default: true\r\n        },\r\n        //  导入前\r\n        beforeImport: {\r\n            type: Function,\r\n            // file为导入文件\r\n            default: file => {}\r\n        },\r\n        // 导入时\r\n        onProgress: {\r\n            type: Function,\r\n            default: (event, file) => {}\r\n        },\r\n        // 状态改变\r\n        onChange: {\r\n            type: Function,\r\n            default: file => {}\r\n        },\r\n        onSuccess: {\r\n            type: Function,\r\n            // response为生成的json数据\r\n            default: (response, file) => {}\r\n        },\r\n        onError: {\r\n            type: Function,\r\n            // err为错误信息\r\n            default: (err, file) => {}\r\n        }\r\n    },\r\n    components: {},\r\n    data() {\r\n        return {\r\n            imFile: \"\",\r\n            // 枚举类\r\n            enum: {\r\n                // 文件类型\r\n                bookType: [\"xlsx\", \"xls\"]\r\n            },\r\n            id: \"\"\r\n        };\r\n    },\r\n    created() {\r\n        this.id = Math.random().toString();\r\n    },\r\n    mounted() {\r\n        this.imFile = document.getElementById(this.id);\r\n    },\r\n    methods: {\r\n        /**\r\n         * @name: 点击导入按钮\r\n         * @param {type}\r\n         * @return:\r\n         */\r\n        importFileClick() {\r\n            this.imFile.click();\r\n        },\r\n        /**\r\n         * @name: 导入文件\r\n         * @param {type}\r\n         * @return:\r\n         */\r\n        importFile() {\r\n            // 导入excel\r\n            const obj = this.imFile;\r\n            // 无导入文件\r\n            if (!obj.files) {\r\n                this.onError(\"No imported file\");\r\n                return;\r\n            }\r\n            const file = obj.files[0];\r\n            // 导入前\r\n            const beforeImport = this.beforeImport(file);\r\n            this.onChange(file);\r\n            if (beforeImport === false) {\r\n                return;\r\n            }\r\n            // 文件类型必须为xlsx或者xls\r\n            const bookType = file.name.substr(\r\n                file.name.length - 4,\r\n                file.name.length - 1\r\n            );\r\n            const type = this.enum.bookType.some(e => {\r\n                if (bookType.indexOf(e) !== -1) {\r\n                    return true;\r\n                }\r\n                return false;\r\n            });\r\n            if (!type) {\r\n                this.onError('The file type must be \"xlsx\" or \"xls\"', file);\r\n                return;\r\n            }\r\n            const reader = new FileReader();\r\n            const that = this;\r\n            // 导入时\r\n            reader.onprogress = e => {\r\n                this.onProgress(e, file);\r\n            };\r\n            // 导入完成\r\n            reader.onload = e => {\r\n                const data = e.target.result;\r\n                if (that.rABS) {\r\n                    that.wb = XLSX.read(btoa(this.fixdata(data)), {\r\n                        // 手动转化\r\n                        type: \"base64\"\r\n                    });\r\n                } else {\r\n                    that.wb = XLSX.read(data, {\r\n                        type: \"binary\"\r\n                    });\r\n                }\r\n                let json = [];\r\n                // 查询对应表名数据\r\n                if (that.sheetNames) {\r\n                    that.sheetNames.forEach(name => {\r\n                        const sheetIndex = that.wb.SheetNames.findIndex(\r\n                            s => s === name\r\n                        );\r\n                        if (sheetIndex !== -1) {\r\n                            const data = XLSX.utils.sheet_to_json(\r\n                                that.wb.Sheets[that.wb.SheetNames[sheetIndex]]\r\n                            );\r\n                            json.push({ sheetName: name, data });\r\n                        }\r\n                    });\r\n                } else {\r\n                    // 查询全部数据\r\n                    that.wb.SheetNames.forEach(item => {\r\n                        const data = XLSX.utils.sheet_to_json(\r\n                            that.wb.Sheets[item]\r\n                        );\r\n                        json.push({ sheetName: item, data });\r\n                    });\r\n                }\r\n                json = this.dealData(json);\r\n                that.importData(json, file);\r\n            };\r\n            if (this.rABS) {\r\n                reader.readAsArrayBuffer(file);\r\n            } else {\r\n                reader.readAsBinaryString(file);\r\n            }\r\n        },\r\n        /**\r\n         * @name: 处理导入数据\r\n         * @param {type}\r\n         * @return:\r\n         */\r\n        dealData(data) {\r\n            if (this.removeBlankspace || this.removeSpecialchar) {\r\n                const json = data.map(item => {\r\n                    const itemData = item.data.map(i => {\r\n                        Object.keys(i).forEach(key => {\r\n                            if (\r\n                                this.removeBlankspace &&\r\n                                Object.prototype.toString.call(i[key]) ===\r\n                                    \"[object String]\"\r\n                            ) {\r\n                                // 字符串去除空格\r\n                                i[key] = i[key].replace(/\\s*/g, \"\");\r\n                            }\r\n                            // 去除特殊字符\r\n                            if (\r\n                                this.removeSpecialchar &&\r\n                                i[key] &&\r\n                                Object.prototype.toString.call(i[key]) !==\r\n                                    \"[object Boolean]\"\r\n                            ) {\r\n                                i[key] = i[key]\r\n                                    .toString()\r\n                                    .replace(\r\n                                        /[\\u200b-\\u200f\\uFEFF\\u202a-\\u202e]/g,\r\n                                        \"\"\r\n                                    );\r\n                            }\r\n                        });\r\n                        return i;\r\n                    });\r\n                    return { ...item, data: itemData };\r\n                });\r\n                return json;\r\n            }\r\n            return data;\r\n        },\r\n        /**\r\n         * @name: 导入数据\r\n         * @param {type}\r\n         * @return:\r\n         */\r\n        importData(data, file) {\r\n            this.imFile.value = \"\";\r\n            if (data.length <= 0) {\r\n                // 导入失败\r\n                this.onChange(file);\r\n                this.onError(\"The import failed\", file);\r\n                return;\r\n            } else {\r\n                //导入成功\r\n                this.onChange(file);\r\n                this.onSuccess(data, file);\r\n                return;\r\n            }\r\n        },\r\n        /**\r\n         * @name: 文件流转BinaryString\r\n         * @param {type}\r\n         * @return:\r\n         */\r\n        fixdata(data) {\r\n            const o = \"\";\r\n            const l = 0;\r\n            const w = 10240;\r\n            for (; l < data.byteLength / w; ++l) {\r\n                o += String.fromCharCode.apply(\r\n                    null,\r\n                    new Uint8Array(data.slice(l * w, l * w + w))\r\n                );\r\n            }\r\n            o += String.fromCharCode.apply(\r\n                null,\r\n                new Uint8Array(data.slice(l * w))\r\n            );\r\n            return o;\r\n        }\r\n    },\r\n    computed: {},\r\n    watch: {}\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n</style>"]}]}